# タスクリスト - Zaikaku Project (Flutter)

## フェーズ 1: セットアップと基盤構築 [完了]
- [x] Flutterプロジェクトの初期化 <!-- id: 0 -->
- [x] 依存関係注入(DI)と状態管理(Riverpod)のセットアップ <!-- id: 1 -->
- [x] 基本的なフォルダ構成の実装 (Clean Architecture) <!-- id: 2 -->
- [x] **動作確認**: アプリがエミュレータでビルド・起動すること <!-- id: 3 -->

## フェーズ 2: コアロジックとスキャン機能 [完了]
- [x] バーコードスキャン画面(UI)の実装 <!-- id: 4 -->
- [x] 照合ロジック(ドメイン層)の実装 <!-- id: 5 -->
- [x] 音声フィードバック(正解音/不正解音)の実装 <!-- id: 6 -->
- [x] スキャン設定画面のUI実装 <!-- id: 22 -->
- [x] デバッグ用画像選択機能（エミュレータ用）の実装 <!-- id: 27 -->
- [x] **動作確認**: 指定された10件のテストケースに基づくスキャン検証 <!-- id: 7 -->

## フェーズ 3: データ永続化とログ機能 [完了]
- [x] ローカルデータベース(Drift/SQLite)のセットアップ <!-- id: 8 -->
- [x] ログリポジトリの実装 <!-- id: 9 -->
- [x] ログ閲覧画面の実装 <!-- id: 10 -->
- [x] 背景（メールアドレスなど）設定の実装 <!-- id: 11 -->
- [x] **動作確認**: スキャン後にログが保存され、一覧で確認できること <!-- id: 12 -->

## フェーズ 4: マスタデータ管理機能 [完了]
- [x] 製品情報（型式・バーコード紐付け）のテーブル定義 <!-- id: 23 -->
- [x] 製品情報の登録・編集・削除画面の実装 <!-- id: 24 -->
  - [x] 画像からのバーコードスキャン機能（複数同時対応）
  - [x] ライブカメラによる連続スキャン機能
- [x] 製品マスタに基づいた照合ロジックへの切り替え <!-- id: 25 -->
- [x] **動作確認**: 製品の登録・変更・削除がスキャン結果に反映されること <!-- id: 26 -->

## フェーズ 4.5: OCR入力機能 (製品名・型番) [完了]
- [x] OCRライブラリの導入 (google_mlkit_text_recognition)
- [x] OCRスキャン画面の実装 (日本語・英数字対応)
- [x] 製品登録画面へのOCRボタン追加と連携

## フェーズ 5: 出力機能と仕上げ [完了]
- [x] ログのエクスポート機能(CSV/メール)の実装 <!-- id: 13 -->
- [x] 「待機」状態の実装 (リセットされるまでスキャンをブロック) <!-- id: 15 -->
- [x] スキャンUIの大幅改修 (ユーザー要望対応)
  - [x] 自動スキャン廃止 -> シャッターボタン方式へ変更
  - [x] 結果表示をカメラオーバーレイ（上部）へ移動
  - [x] ガイド枠のデザイン・色変更（黄->赤）
  - [x] 戻るボタンの追加、デモアイコン削除
  - [x] 確認ボタンで結果表示もクリア
  - [x] 画面下部への材料リスト表示 (チェックマーク付き)
  - [x] リスト高さ可変、半透明背景、行間短縮
  - [x] シャッターボタン右配置、エラー表示追加
- [x] UIの調整 (アニメーション、遷移、ダイナミックカラー) <!-- id: 14 -->
- [x] **動作確認**: 全体ワークフローのテスト (スキャン -> 照合 -> ログ -> ログ出力) <!-- id: 16 -->

## フェーズ 6: リリース準備とAdMob実装 [完了]
- [x] **フェーズ6計画策定** (AdMob追加に伴う再策定)
- [x] Google AdMobの導入 (`google_mobile_ads`)
  - [x] AndroidManifestへのApp ID設定 (测试用)
  - [x] バナー広告ウィジェットの実装 (スキャン画面/履歴画面等)
- [x] アプリアイコンの作成と適用 (`flutter_launcher_icons`)
  - [x] アイコンサイズ最大化と透過の設定
- [x] アプリ名（材確）とパッケージ名の最終確認
- [x] READMEとドキュメントの更新
- [x] **動作確認**: テスト広告の表示、アイコン外観、および起動確認

## フェーズ 7: ストア公開準備と製品化設定 [完了]
- [x] 本番用AdMob設定
  - [x] AdMobコンソールでのアプリ・広告ユニット作成 (ユーザー実施済)
  - [x] 本番用App ID/ユニットIDへの差し替え (AdHelperで準備完了)
  - [x] app-ads.txt の配置準備 (ガイド参照)
- [x] 法的・ドキュメント対応
  - [x] 取扱説明書 (docs/USER_MANUAL.md) の作成
  - [x] プライバシーポリシーの作成とアプリ内掲示
  - [x] OSSライセンス表示機能の実装 (showLicensePage)
- [x] Google Play Store 登録準備
  - [x] リリース用署名鍵 (jks) の設定 (key.propertiesテンプレート作成済)
  - [x] build.gradleへの署名構成追加
  - [x] ストア掲載情報の作成（説明文、プライバシーポリシーURL等）(ガイド作成済)
  - [x] スクリーンショット、フィーチャーグラフィックの作成 (ユーザー実施)
- [x] 最終ビルドと品質確認
  - [x] `flutter build appbundle --release` によるリリースビルド生成 ([SUCCESS] 71.2MB)
  - [x] 難読化 (ProGuard/R8) の設定確認 (proguard-rules.pro作成済)
  - [x] 実機での最終回帰テスト (内部テストでの実施へ移行)

## フェーズ 8: ストア審査と公開 [完了]
**状態**: **修正版リリース提出済み**
- [x] **フェーズ8計画策定** (2026-02-01 19:09 承認済み)
- [x] **事前準備** (承認済み)
  - [x] **プレ準備**（エージェント・ユーザー共同）
  - [x] アプリアイコン512x512pxの準備
  - [x] スクリーンショット撮影（最低4枚） (完了)
  - [x] フィーチャーグラフィック作成（1024x500px）
  - [x] プライバシーポリシーURL準備 (GitHub Pages公開完了) <!-- id: 89 -->
- [x] **Google Play Console登録**（ユーザー実施）
  - [x] アプリ作成（アプリ名、言語、種類設定） (完了)
  - [x] ストア掲載情報入力（説明文、画像アップロード） (完了)
  - [x] プライバシーとセキュリティ設定 (アクセス権限、AdMob宣言完了)
  - [x] 各種宣言（行政、金融、健康）の回答 (完了)
  - [x] データセーフティの回答 (完了)
  - [x] アプリカテゴリとタグ、連絡先の設定 (完了)
  - [x] 対象ユーザーとコンテンツ設定 (完了)
- [x] **リリースアップロード**（ユーザー実施）
  - [x] 製品版トラックを選択 (完了)
  - [x] AABファイルアップロード (完了)
  - [x] リリースノート記入 (完了)
  - [x] エラー・警告の解消 (完了)
- [x] **審査提出**（ユーザー実施）
  - [x] 審査へ送信 (2026-02-01 22:14 提出済み)
- [x] **実機検証（動作およびUI確認）**（ユーザー実施/エージェント支援）
  - [x] USBデバッグ接続の確立 (完了)
  - [x] 実機のADB認識確認 (完了)
  - [x] 実機ビルドおよびインストール (完了)
  - [x] スキャン種別フィルタ（1D/2D）の反映 (合格)
  - [x] スキャン範囲（単一）の精度 (合格)
  - [x] スキャン範囲（複数）のリセット動作 (完了)
  - [x] バリデーション検知の拡充 (JAN-8対応等) (完了)
  - [x] Start/Stop文字検証 (完了)
- [x] **バグ再修正と追加検証**
  - [x] 再修正計画の承認 (2026-02-01 23:49 承認済み)
  - [x] 検証用デモ画像 (demo_8~11) の生成 (完了)
  - [x] スキャン窓の完全リセット実装 (合格・動作確認済み)
  - [x] バリデーション検知の拡充 (完了)
  - [x] 実機カメラ・シャッター不具合の修正と復旧 (完了)
  - [x] 初期画面の設定復旧と遷移機能（戻るボタン）の不備修正 (合格)
  - [x] 実機での再検証依頼 (検証用画像のパス提示中)
  - [x] リリースビルド (v1.0.1+2) の生成と完了

## フェーズ 9: スキャンUI改善 [未着手]
- [ ] **スキャンUIの刷新 (オーバーレイマスクと横幅拡張)**
  - [ ] 実装計画書の作成 (implementation_plan_phase9.md)
  - [ ] 読み取りエリア外を暗くするマスク表示の実装
  - [ ] 読み取りエリア（ナローモード）の横幅最大化
  - [ ] 中央レーザーラインの維持
  - [ ] scanWindow計算ロジックの追随
- [ ] **ドキュメント更新**
  - [ ] Task.md更新
  - [ ] Walkthrough.md更新
  - [ ] README.md更新
  - [ ] GitHub コミット・プッシュ

## フェーズ 10: ストア公開と次期開発（維持管理） [未着手]
- [ ] **ストア審査と公開** (Phase 8より移行)
  - [ ] 審査通過待ち
  - [ ] 公開ボタンクリック
  - [ ] 公開後確認
    - [ ] ストア表示確認
    - [ ] ストアからのインストールテスト
    - [ ] 主要機能の動作確認
